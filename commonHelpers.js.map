{"version":3,"file":"commonHelpers.js","sources":["../src/pixabay-api.js","../src/render-functions.js","../src/loadMoreButton.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport const requestServer = {\n    url: 'https://pixabay.com/api/',\n    params: {\n        key: '35337679-b7947e609f482c58d47f4cd5a',\n        q: '',\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        page: 1,\n        per_page: 20\n    },\n    \n    onRequestServer(query = this.params.q) {\n        this.params.q = query;\n        this.params.page += 1;\n        return axios.get(this.url, { params: this.params })\n    }  \n}\n\n","export function markup(array) {\n  return array.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => {\n    return `\n    <div class=\"gallery__item\">\n      <a class=\"gallery__link\" href=\"${largeImageURL}\">\n        <img class=\"gallery__image\" src=\"${webformatURL}\" alt=\"${tags}\"/>\n      </a>\n      <div class=\"gallery__info\">\n        <p class=\"gallery__info-item\">\n          <b>Likes ${likes}</b>\n        </p>\n        <p class=\"gallery__info-item\">\n          <b>Views ${views}</b>\n        </p>\n        <p class=\"gallery__info-item\">\n          <b>Comments ${comments}</b>\n        </p>\n        <p class=\"gallery__info-item\">\n          <b>Downloads ${downloads}</b>\n        </p>\n      </div>\n    </div>`\n  }).join(\"\");\n}        ","export const loadMoreButton = {\n    isHiden: true,\n    disabled: true,\n    loading: false,\n    buttonAdress: null,\n\n    buttonState({ isHiden = this.isHiden, disabled = this.disabled, loading = this.loading }) {\n        isHiden ? this.buttonAdress.classList.add('visually-hidden') : this.buttonAdress.classList.remove('visually-hidden');\n        disabled ? this.buttonAdress.disabled = true : this.buttonAdress.disabled = false;\n        loading ? this.buttonAdress.textContent = 'Loading...' : this.buttonAdress.textContent = 'Load-more';\n    }\n}","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport { requestServer } from './pixabay-api';\n\nimport { markup } from \"./render-functions\";\nimport { loadMoreButton } from './loadMoreButton';\n\nconst refs = {\n    form: document.querySelector('#search-form'),\n    gallery: document.querySelector('.gallery'),\n    loadMoreButton: document.querySelector('.load-more'),\n    searchButton: document.querySelector('#search-form button'),\n};\n\n\nloadMoreButton.buttonAdress = refs.loadMoreButton\n\nlet totalImagesUploaded = 20;\n\nloadMoreButton.buttonState({});\n\nrefs.form.addEventListener('submit', onSumbitForm);\nrefs.loadMoreButton.addEventListener('click', onSumbitLoadMore);\n\nasync function onSumbitForm(event) {\n    event.preventDefault();\n    const { searchQuery } = event.currentTarget.elements;\n    if (!searchQuery.value.trim()) {\n        iziToast.info({\n            message: 'Please, enter data to search!',\n            position: \"topRight\"\n        });\n        return;\n    }\n    refs.searchButton.disabled = true;\n    requestServer.params.page = 0;\n    refs.gallery.innerHTML = '';\n    loadMoreButton.buttonState({\n        isHiden: false,\n        loading: true,\n    });\n\n    try {\n        const response = await requestServer.onRequestServer(searchQuery.value);\n\n        const { hits, totalHits } = response.data;\n\n        if (!totalHits) {\n            iziToast.error({\n                message: \"Sorry, there are no images matching your search query. Please try again.\",\n                position: \"topRight\"\n            });\n            loadMoreButton.buttonState({ isHiden: true });\n            refs.searchButton.disabled = false;\n            return;\n        }\n\n        iziToast.success({\n            message: `Hooray! We found ${totalHits} images.`,\n            position: \"topRight\"\n        });\n        refs.gallery.insertAdjacentHTML(\"beforeend\", markup(hits));\n        refs.searchButton.disabled = false;\n\n        const lightbox = new SimpleLightbox('.gallery a');\n        lightbox.refresh();\n\n        if (totalHits <= 20) {\n            loadMoreButton.buttonState({\n                isHiden: true,\n                disabled: true,\n            })\n        } else {\n            loadMoreButton.buttonState({\n                isHiden: false,\n                disabled: false,\n                loading: false,\n            });\n        }\n    } catch (error) {\n        console.log(error);\n        loadMoreButton.buttonState({\n            isHiden: true,\n            disabled: true,\n        })\n    };\n}\n\nasync function onSumbitLoadMore(event) {\n    loadMoreButton.buttonState({\n        disabled: true,\n        loading: true,\n        isHiden: false,\n    });\n    try {\n        const response = await requestServer.onRequestServer();\n        const { hits, totalHits } = response.data;\n\n        refs.gallery.insertAdjacentHTML(\"beforeend\", markup(hits));\n        loadMoreButton.buttonState({\n            isHiden: false,\n            disabled: false,\n            loading: false,\n        });\n\n        totalImagesUploaded += 20;\n        if (totalImagesUploaded >= totalHits) {\n            iziToast.warning({\n                message: \"We're sorry, but you've reached the end of search results.\",\n                position: \"topRight\"\n            });\n            loadMoreButton.buttonState({\n                isHiden: true,\n                disabled: true,\n            });\n        }\n        const { height: cardHeight } = document.querySelector(\".gallery\").firstElementChild.getBoundingClientRect();\n        window.scrollBy({\n            top: cardHeight * 2,\n            // top: cardHeight * 2.55,\n            behavior: \"smooth\",\n        });\n        const lightbox = new SimpleLightbox('.gallery a');\n        lightbox.refresh();\n\n    } catch (error) {\n        console.log(error);\n    };\n}"],"names":["requestServer","query","axios","markup","array","webformatURL","largeImageURL","tags","likes","views","comments","downloads","loadMoreButton","isHiden","disabled","loading","refs","totalImagesUploaded","onSumbitForm","onSumbitLoadMore","event","searchQuery","iziToast","response","hits","totalHits","SimpleLightbox","error","cardHeight"],"mappings":"owBAEO,MAAMA,EAAgB,CACzB,IAAK,2BACL,OAAQ,CACJ,IAAK,qCACL,EAAG,GACH,WAAY,QACZ,YAAa,aACb,WAAY,OACZ,KAAM,EACN,SAAU,EACb,EAED,gBAAgBC,EAAQ,KAAK,OAAO,EAAG,CACnC,YAAK,OAAO,EAAIA,EAChB,KAAK,OAAO,MAAQ,EACbC,EAAM,IAAI,KAAK,IAAK,CAAE,OAAQ,KAAK,OAAQ,CACrD,CACL,ECnBO,SAASC,EAAOC,EAAO,CAC5B,OAAOA,EAAM,IAAI,CAAC,CAAE,aAAAC,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAS,IAC/E;AAAA;AAAA,uCAE4BL,CAAa;AAAA,2CACTD,CAAY,UAAUE,CAAI;AAAA;AAAA;AAAA;AAAA,qBAIhDC,CAAK;AAAA;AAAA;AAAA,qBAGLC,CAAK;AAAA;AAAA;AAAA,wBAGFC,CAAQ;AAAA;AAAA;AAAA,yBAGPC,CAAS;AAAA;AAAA;AAAA,WAI/B,EAAE,KAAK,EAAE,CACZ,CCvBO,MAAMC,EAAiB,CAC1B,QAAS,GACT,SAAU,GACV,QAAS,GACT,aAAc,KAEd,YAAY,CAAE,QAAAC,EAAU,KAAK,QAAS,SAAAC,EAAW,KAAK,SAAU,QAAAC,EAAU,KAAK,OAAO,EAAI,CACtFF,EAAU,KAAK,aAAa,UAAU,IAAI,iBAAiB,EAAI,KAAK,aAAa,UAAU,OAAO,iBAAiB,EACnHC,EAAW,KAAK,aAAa,SAAW,GAAO,KAAK,aAAa,SAAW,GAC5EC,EAAU,KAAK,aAAa,YAAc,aAAe,KAAK,aAAa,YAAc,WAC5F,CACL,ECCMC,EAAO,CACT,KAAM,SAAS,cAAc,cAAc,EAC3C,QAAS,SAAS,cAAc,UAAU,EAC1C,eAAgB,SAAS,cAAc,YAAY,EACnD,aAAc,SAAS,cAAc,qBAAqB,CAC9D,EAGAJ,EAAe,aAAeI,EAAK,eAEnC,IAAIC,EAAsB,GAE1BL,EAAe,YAAY,CAAA,CAAE,EAE7BI,EAAK,KAAK,iBAAiB,SAAUE,CAAY,EACjDF,EAAK,eAAe,iBAAiB,QAASG,CAAgB,EAE9D,eAAeD,EAAaE,EAAO,CAC/BA,EAAM,eAAc,EACpB,KAAM,CAAE,YAAAC,CAAa,EAAGD,EAAM,cAAc,SAC5C,GAAI,CAACC,EAAY,MAAM,OAAQ,CAC3BC,EAAS,KAAK,CACV,QAAS,gCACT,SAAU,UACtB,CAAS,EACD,MACH,CACDN,EAAK,aAAa,SAAW,GAC7BhB,EAAc,OAAO,KAAO,EAC5BgB,EAAK,QAAQ,UAAY,GACzBJ,EAAe,YAAY,CACvB,QAAS,GACT,QAAS,EACjB,CAAK,EAED,GAAI,CACA,MAAMW,EAAW,MAAMvB,EAAc,gBAAgBqB,EAAY,KAAK,EAEhE,CAAE,KAAAG,EAAM,UAAAC,GAAcF,EAAS,KAErC,GAAI,CAACE,EAAW,CACZH,EAAS,MAAM,CACX,QAAS,2EACT,SAAU,UAC1B,CAAa,EACDV,EAAe,YAAY,CAAE,QAAS,EAAM,CAAA,EAC5CI,EAAK,aAAa,SAAW,GAC7B,MACH,CAEDM,EAAS,QAAQ,CACb,QAAS,oBAAoBG,CAAS,WACtC,SAAU,UACtB,CAAS,EACDT,EAAK,QAAQ,mBAAmB,YAAab,EAAOqB,CAAI,CAAC,EACzDR,EAAK,aAAa,SAAW,GAEZ,IAAIU,EAAe,YAAY,EACvC,QAAO,EAEZD,GAAa,GACbb,EAAe,YAAY,CACvB,QAAS,GACT,SAAU,EAC1B,CAAa,EAEDA,EAAe,YAAY,CACvB,QAAS,GACT,SAAU,GACV,QAAS,EACzB,CAAa,CAER,OAAQe,EAAO,CACZ,QAAQ,IAAIA,CAAK,EACjBf,EAAe,YAAY,CACvB,QAAS,GACT,SAAU,EACtB,CAAS,CACT,CACA,CAEA,eAAeO,EAAiBC,EAAO,CACnCR,EAAe,YAAY,CACvB,SAAU,GACV,QAAS,GACT,QAAS,EACjB,CAAK,EACD,GAAI,CACA,MAAMW,EAAW,MAAMvB,EAAc,kBAC/B,CAAE,KAAAwB,EAAM,UAAAC,GAAcF,EAAS,KAErCP,EAAK,QAAQ,mBAAmB,YAAab,EAAOqB,CAAI,CAAC,EACzDZ,EAAe,YAAY,CACvB,QAAS,GACT,SAAU,GACV,QAAS,EACrB,CAAS,EAEDK,GAAuB,GACnBA,GAAuBQ,IACvBH,EAAS,QAAQ,CACb,QAAS,6DACT,SAAU,UAC1B,CAAa,EACDV,EAAe,YAAY,CACvB,QAAS,GACT,SAAU,EAC1B,CAAa,GAEL,KAAM,CAAE,OAAQgB,CAAU,EAAK,SAAS,cAAc,UAAU,EAAE,kBAAkB,wBACpF,OAAO,SAAS,CACZ,IAAKA,EAAa,EAElB,SAAU,QACtB,CAAS,EACgB,IAAIF,EAAe,YAAY,EACvC,QAAO,CAEnB,OAAQC,EAAO,CACZ,QAAQ,IAAIA,CAAK,CAEzB,CAAA"}